## 你了解vue中的diff算法吗？

#### 题目分析：
vue基于虚拟DOM做更新，diff又是其核心部分，因此常被问道，此题考查面试者深度。


#### 答题思路：3w1h

1. 定义diff
2. 它的必要性
3. 它在哪里被使用
4. 它如何运作
5. 提升：说一些细节


#### 回答范例：

1. diff算法是虚拟DOM技术的产物，vue里面实际叫做patch，它的核心实现来自于snabbdom；通过新旧虚拟DOM作对比（即patch），将变化的地方转换为DOM操作
2. 在vue 1中是没有patch的，因为界面中每个依赖都有专门的watcher负责更新，这样项目规模变大就会成为性能瓶颈，vue 2中为了降低watcher粒度，每个组件只有一个watcher，但是当需要更新的时候，怎样才能精确找到发生变化的地方？这就需要引入patch才行。
3. 组件中数据发生变化时，对应的watcher会通知更新并执行其更新函数，它会执行渲染函数获取全新虚拟dom：newVnode，此时就会执行patch比对上次渲染结果oldVnode和新的渲染结果newVnode。
4. patch过程遵循深度优先、同层比较的策略；两个节点之间比较时，如果它们拥有子节点，会先比较子节点；比较两组子节点时，会假设头尾节点可能相同先做尝试，没有找到相同节点后才按照通用方式遍历查找；查找结束再按情况处理剩下的节点；借助key通常可以非常精确找到相同节点，因此整个patch过程非常高效。

![imgs](https://delfinobook.oss-cn-beijing.aliyuncs.com/998023-20180519212338609-1617459354.png)


知其所以然：测试代码[test.html](test.html)

